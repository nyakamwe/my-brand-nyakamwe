{"version":3,"sources":["AuthenticateToken.js"],"names":["authenticateToken","req","res","next","authHeader","headers","token","split","status","json","message","jwt","verify","process","env","ACCESS_TOKEN_SECRET","error","user"],"mappings":";;;;;;;AAAA;;;;AAGO,SAASA,iBAAT,CAA2BC,GAA3B,EAAgCC,GAAhC,EAAqCC,IAArC,EAA0C;AAChD,QAAMC,UAAU,GAAGH,GAAG,CAACI,OAAJ,CAAY,eAAZ,CAAnB;AACA,QAAMC,KAAK,GAAGF,UAAU,IAAIA,UAAU,CAACG,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAA5B;AACA,MAAGD,KAAK,IAAI,IAAZ,EAAkB,OAAOJ,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,IAAAA,OAAO,EAAC;AAAT,GAArB,CAAP;;AAElBC,wBAAIC,MAAJ,CAAWN,KAAX,EAAkBO,OAAO,CAACC,GAAR,CAAYC,mBAA9B,EAAmD,CAACC,KAAD,EAAQC,IAAR,KAAe;AACjE,QAAGD,KAAH,EAAU,OAAOd,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,MAAAA,OAAO,EAAC;AAAT,KAArB,CAAP;AAEVT,IAAAA,GAAG,CAACgB,IAAJ,GAASA,IAAT;AAEAd,IAAAA,IAAI;AACJ,GAND;AAOA","sourceRoot":"/home/nyakamwe/Desktop/my-brand-nyakamwe/server/src/AuthMiddleWare/","sourcesContent":["import jwt from 'jsonwebtoken'\n\n\nexport function authenticateToken(req, res, next){\n\tconst authHeader = req.headers['authorization']\n\tconst token = authHeader && authHeader.split(' ')[1]\n\tif(token == null) return res.status(401).json({message:'Token is required'})\n\n\tjwt.verify(token, process.env.ACCESS_TOKEN_SECRET, (error, user)=>{\n\t\tif(error) return res.status(403).json({message:\"Invalid token\"})\n\n\t\treq.user=user;\n\n\t\tnext();\n\t})\n}\n"]}