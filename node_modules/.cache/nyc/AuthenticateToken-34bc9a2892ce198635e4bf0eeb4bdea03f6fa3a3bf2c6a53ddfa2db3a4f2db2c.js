"use strict";function cov_12p3osm1eu(){var path="/home/nyakamwe/Desktop/my-brand-nyakamwe/server/src/AuthMiddleWare/AuthenticateToken.js";var hash="e09a16dfc620b5c39d684345506158a4a5958b67";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/nyakamwe/Desktop/my-brand-nyakamwe/server/src/AuthMiddleWare/AuthenticateToken.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:6,column:0},end:{line:6,column:46}},"2":{start:{line:8,column:20},end:{line:8,column:67}},"3":{start:{line:10,column:39},end:{line:10,column:93}},"4":{start:{line:13,column:21},end:{line:13,column:49}},"5":{start:{line:14,column:16},end:{line:14,column:54}},"6":{start:{line:15,column:2},end:{line:17,column:5}},"7":{start:{line:15,column:21},end:{line:17,column:5}},"8":{start:{line:19,column:2},end:{line:25,column:5}},"9":{start:{line:20,column:4},end:{line:22,column:7}},"10":{start:{line:20,column:15},end:{line:22,column:7}},"11":{start:{line:23,column:4},end:{line:23,column:20}},"12":{start:{line:24,column:4},end:{line:24,column:11}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:10,column:9},end:{line:10,column:31}},loc:{start:{line:10,column:37},end:{line:10,column:95}},line:10},"1":{name:"authenticateToken",decl:{start:{line:12,column:9},end:{line:12,column:26}},loc:{start:{line:12,column:43},end:{line:26,column:1}},line:12},"2":{name:"(anonymous_2)",decl:{start:{line:19,column:71},end:{line:19,column:72}},loc:{start:{line:19,column:88},end:{line:25,column:3}},line:19}},branchMap:{"0":{loc:{start:{line:10,column:46},end:{line:10,column:92}},type:"cond-expr",locations:[{start:{line:10,column:70},end:{line:10,column:73}},{start:{line:10,column:76},end:{line:10,column:92}}],line:10},"1":{loc:{start:{line:10,column:46},end:{line:10,column:67}},type:"binary-expr",locations:[{start:{line:10,column:46},end:{line:10,column:49}},{start:{line:10,column:53},end:{line:10,column:67}}],line:10},"2":{loc:{start:{line:14,column:16},end:{line:14,column:54}},type:"binary-expr",locations:[{start:{line:14,column:16},end:{line:14,column:26}},{start:{line:14,column:30},end:{line:14,column:54}}],line:14},"3":{loc:{start:{line:15,column:2},end:{line:17,column:5}},type:"if",locations:[{start:{line:15,column:2},end:{line:17,column:5}},{start:{line:15,column:2},end:{line:17,column:5}}],line:15},"4":{loc:{start:{line:20,column:4},end:{line:22,column:7}},type:"if",locations:[{start:{line:20,column:4},end:{line:22,column:7}},{start:{line:20,column:4},end:{line:22,column:7}}],line:20}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},inputSourceMap:{version:3,sources:["AuthenticateToken.js"],names:["authenticateToken","req","res","next","authHeader","headers","token","split","status","json","message","jwt","verify","process","env","ACCESS_TOKEN_SECRET","error","user"],mappings:";;;;;;;AAAA;;;;AAGO,SAASA,iBAAT,CAA2BC,GAA3B,EAAgCC,GAAhC,EAAqCC,IAArC,EAA0C;AAChD,QAAMC,UAAU,GAAGH,GAAG,CAACI,OAAJ,CAAY,eAAZ,CAAnB;AACA,QAAMC,KAAK,GAAGF,UAAU,IAAIA,UAAU,CAACG,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAA5B;AACA,MAAGD,KAAK,IAAI,IAAZ,EAAkB,OAAOJ,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,IAAAA,OAAO,EAAC;AAAT,GAArB,CAAP;;AAElBC,wBAAIC,MAAJ,CAAWN,KAAX,EAAkBO,OAAO,CAACC,GAAR,CAAYC,mBAA9B,EAAmD,CAACC,KAAD,EAAQC,IAAR,KAAe;AACjE,QAAGD,KAAH,EAAU,OAAOd,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,MAAAA,OAAO,EAAC;AAAT,KAArB,CAAP;AAEVT,IAAAA,GAAG,CAACgB,IAAJ,GAASA,IAAT;AAEAd,IAAAA,IAAI;AACJ,GAND;AAOA",sourceRoot:"/home/nyakamwe/Desktop/my-brand-nyakamwe/server/src/AuthMiddleWare/",sourcesContent:["import jwt from 'jsonwebtoken'\n\n\nexport function authenticateToken(req, res, next){\n\tconst authHeader = req.headers['authorization']\n\tconst token = authHeader && authHeader.split(' ')[1]\n\tif(token == null) return res.status(401).json({message:'Token is required'})\n\n\tjwt.verify(token, process.env.ACCESS_TOKEN_SECRET, (error, user)=>{\n\t\tif(error) return res.status(403).json({message:\"Invalid token\"})\n\n\t\treq.user=user;\n\n\t\tnext();\n\t})\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"e09a16dfc620b5c39d684345506158a4a5958b67"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_12p3osm1eu=function(){return actualCoverage;};}return actualCoverage;}cov_12p3osm1eu();cov_12p3osm1eu().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_12p3osm1eu().s[1]++;exports.authenticateToken=authenticateToken;var _jsonwebtoken=(cov_12p3osm1eu().s[2]++,_interopRequireDefault(require("jsonwebtoken")));function _interopRequireDefault(obj){cov_12p3osm1eu().f[0]++;cov_12p3osm1eu().s[3]++;return(cov_12p3osm1eu().b[1][0]++,obj)&&(cov_12p3osm1eu().b[1][1]++,obj.__esModule)?(cov_12p3osm1eu().b[0][0]++,obj):(cov_12p3osm1eu().b[0][1]++,{default:obj});}function authenticateToken(req,res,next){cov_12p3osm1eu().f[1]++;const authHeader=(cov_12p3osm1eu().s[4]++,req.headers['authorization']);const token=(cov_12p3osm1eu().s[5]++,(cov_12p3osm1eu().b[2][0]++,authHeader)&&(cov_12p3osm1eu().b[2][1]++,authHeader.split(' ')[1]));cov_12p3osm1eu().s[6]++;if(token==null){cov_12p3osm1eu().b[3][0]++;cov_12p3osm1eu().s[7]++;return res.status(401).json({message:'Token is required'});}else{cov_12p3osm1eu().b[3][1]++;}cov_12p3osm1eu().s[8]++;_jsonwebtoken.default.verify(token,process.env.ACCESS_TOKEN_SECRET,(error,user)=>{cov_12p3osm1eu().f[2]++;cov_12p3osm1eu().s[9]++;if(error){cov_12p3osm1eu().b[4][0]++;cov_12p3osm1eu().s[10]++;return res.status(403).json({message:"Invalid token"});}else{cov_12p3osm1eu().b[4][1]++;}cov_12p3osm1eu().s[11]++;req.user=user;cov_12p3osm1eu().s[12]++;next();});}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkF1dGhlbnRpY2F0ZVRva2VuLmpzIl0sIm5hbWVzIjpbImF1dGhlbnRpY2F0ZVRva2VuIiwicmVxIiwicmVzIiwibmV4dCIsImF1dGhIZWFkZXIiLCJoZWFkZXJzIiwidG9rZW4iLCJzcGxpdCIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiand0IiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIkFDQ0VTU19UT0tFTl9TRUNSRVQiLCJlcnJvciIsInVzZXIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7OztBQUdPLFNBQVNBLGlCQUFULENBQTJCQyxHQUEzQixFQUFnQ0MsR0FBaEMsRUFBcUNDLElBQXJDLEVBQTBDO0FBQ2hELFFBQU1DLFVBQVUsR0FBR0gsR0FBRyxDQUFDSSxPQUFKLENBQVksZUFBWixDQUFuQjtBQUNBLFFBQU1DLEtBQUssR0FBR0YsVUFBVSxJQUFJQSxVQUFVLENBQUNHLEtBQVgsQ0FBaUIsR0FBakIsRUFBc0IsQ0FBdEIsQ0FBNUI7QUFDQSxNQUFHRCxLQUFLLElBQUksSUFBWixFQUFrQixPQUFPSixHQUFHLENBQUNNLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUFDQyxJQUFBQSxPQUFPLEVBQUM7QUFBVCxHQUFyQixDQUFQOztBQUVsQkMsd0JBQUlDLE1BQUosQ0FBV04sS0FBWCxFQUFrQk8sT0FBTyxDQUFDQyxHQUFSLENBQVlDLG1CQUE5QixFQUFtRCxDQUFDQyxLQUFELEVBQVFDLElBQVIsS0FBZTtBQUNqRSxRQUFHRCxLQUFILEVBQVUsT0FBT2QsR0FBRyxDQUFDTSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFBQ0MsTUFBQUEsT0FBTyxFQUFDO0FBQVQsS0FBckIsQ0FBUDtBQUVWVCxJQUFBQSxHQUFHLENBQUNnQixJQUFKLEdBQVNBLElBQVQ7QUFFQWQsSUFBQUEsSUFBSTtBQUNKLEdBTkQ7QUFPQSIsInNvdXJjZVJvb3QiOiIvaG9tZS9ueWFrYW13ZS9EZXNrdG9wL215LWJyYW5kLW55YWthbXdlL3NlcnZlci9zcmMvQXV0aE1pZGRsZVdhcmUvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nXG5cblxuZXhwb3J0IGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVRva2VuKHJlcSwgcmVzLCBuZXh0KXtcblx0Y29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzWydhdXRob3JpemF0aW9uJ11cblx0Y29uc3QgdG9rZW4gPSBhdXRoSGVhZGVyICYmIGF1dGhIZWFkZXIuc3BsaXQoJyAnKVsxXVxuXHRpZih0b2tlbiA9PSBudWxsKSByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe21lc3NhZ2U6J1Rva2VuIGlzIHJlcXVpcmVkJ30pXG5cblx0and0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuQUNDRVNTX1RPS0VOX1NFQ1JFVCwgKGVycm9yLCB1c2VyKT0+e1xuXHRcdGlmKGVycm9yKSByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLmpzb24oe21lc3NhZ2U6XCJJbnZhbGlkIHRva2VuXCJ9KVxuXG5cdFx0cmVxLnVzZXI9dXNlcjtcblxuXHRcdG5leHQoKTtcblx0fSlcbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJtYXBwaW5ncyI6ImkwSUFNdUQ7Z1BBTnZELGtWQUdPLFFBQVNBLGtCQUFULENBQTJCQyxHQUEzQixDQUFnQ0MsR0FBaEMsQ0FBcUNDLElBQXJDLENBQTBDLHlCQUNoRCxLQUFNQyxXQUFVLDBCQUFHSCxHQUFHLENBQUNJLE9BQUpKLENBQVksZUFBWkEsQ0FBSCxDQUFoQixDQUNBLEtBQU1LLE1BQUssMEJBQUdGLHNDQUFVLCtCQUFJQSxVQUFVLENBQUNHLEtBQVhILENBQWlCLEdBQWpCQSxFQUFzQixDQUF0QkEsQ0FBSixDQUFiLENBQVgsQ0FGZ0Qsd0JBR2hELEdBQUdFLEtBQUssRUFBSSxJQUFaLENBQWtCLDBEQUFPSixJQUFHLENBQUNNLE1BQUpOLENBQVcsR0FBWEEsRUFBZ0JPLElBQWhCUCxDQUFxQixDQUFDUSxPQUFPLENBQUMsbUJBQVQsQ0FBckJSLENBQVAsRUFBbEIsaUNBSGdELHdCQUtoRFMsc0JBQUlDLE1BQUpELENBQVdMLEtBQVhLLENBQWtCRSxPQUFPLENBQUNDLEdBQVJELENBQVlFLG1CQUE5QkosQ0FBbUQsQ0FBQ0ssS0FBRCxDQUFRQyxJQUFSLEdBQWUsaURBQ2pFLEdBQUdELEtBQUgsQ0FBVSwyREFBT2QsSUFBRyxDQUFDTSxNQUFKTixDQUFXLEdBQVhBLEVBQWdCTyxJQUFoQlAsQ0FBcUIsQ0FBQ1EsT0FBTyxDQUFDLGVBQVQsQ0FBckJSLENBQVAsRUFBVixpQ0FEaUUseUJBR2pFRCxHQUFHLENBQUNnQixJQUFKaEIsQ0FBU2dCLElBQVRoQixDQUhpRSx5QkFLakVFLElBQUksR0FMTCxHQU9BIiwibmFtZXMiOlsiYXV0aGVudGljYXRlVG9rZW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJ0b2tlbiIsInNwbGl0Iiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJqd3QiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiQUNDRVNTX1RPS0VOX1NFQ1JFVCIsImVycm9yIiwidXNlciJdLCJzb3VyY2VSb290IjoiL2hvbWUvbnlha2Ftd2UvRGVza3RvcC9teS1icmFuZC1ueWFrYW13ZS9zZXJ2ZXIvc3JjL0F1dGhNaWRkbGVXYXJlLyIsInNvdXJjZXMiOlsiQXV0aGVudGljYXRlVG9rZW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nXG5cblxuZXhwb3J0IGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVRva2VuKHJlcSwgcmVzLCBuZXh0KXtcblx0Y29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzWydhdXRob3JpemF0aW9uJ11cblx0Y29uc3QgdG9rZW4gPSBhdXRoSGVhZGVyICYmIGF1dGhIZWFkZXIuc3BsaXQoJyAnKVsxXVxuXHRpZih0b2tlbiA9PSBudWxsKSByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe21lc3NhZ2U6J1Rva2VuIGlzIHJlcXVpcmVkJ30pXG5cblx0and0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuQUNDRVNTX1RPS0VOX1NFQ1JFVCwgKGVycm9yLCB1c2VyKT0+e1xuXHRcdGlmKGVycm9yKSByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLmpzb24oe21lc3NhZ2U6XCJJbnZhbGlkIHRva2VuXCJ9KVxuXG5cdFx0cmVxLnVzZXI9dXNlcjtcblxuXHRcdG5leHQoKTtcblx0fSlcbn1cbiJdfQ==